---
import { getAllBrands } from '../../api/brands';
import { getTeasGroupedByBrands } from '../../api/teas';
import BrandCard from '../../components/BrandCard.astro';
import Layout from '../../layouts/Layout.astro';

const [brands, groupedTeas] = await Promise.all([
	getAllBrands(),
	getTeasGroupedByBrands()
]);
---

<Layout title="Brands">
	<h1>Brands</h1>
	<ul class="card-list">
		{brands.map(brand => (
			<BrandCard
				brand={brand}
				teas={groupedTeas[brand._id.toString()]}
			/>
		))}
	</ul>
</Layout>

<style lang="scss">
	@use 'open-props-scss' as op;
	@use '../../styles/tokens.scss' as tokens;
	
	.card-list {
		list-style: none;
		display: grid;
		--min: 30ch;
		grid-template-columns: repeat(
			auto-fill,
			minmax(
				min(100%, var(--min)),
				1fr
			));
		gap: op.$size-fluid-2 op.$size-fluid-3;
		margin-block: op.$size-fluid-2;
	}
</style>